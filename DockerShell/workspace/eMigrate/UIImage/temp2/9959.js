"use strict";(self.webpackChunke_migrate=self.webpackChunke_migrate||[]).push([[9959],{9959:(L,b,i)=>{i.r(b),i.d(b,{SearchModule:()=>Q});var c,u=i(6895),m=i(3599),d=i(1358),l=i(2976),e=i(1571),v=i(6945),f=i(805),T=i(655),S=i(8513),F=i(8505),C=i(262);class h{constructor(a){this.internalSearchService=a}fetchOpenJobs(a){return this.internalSearchService.fetchOpenJobs(a).pipe((0,F.b)(n=>{}),(0,C.K)(n=>{throw n}))}fetchValueFromMaster(a,n){const o=n.find(t=>t.value==a);return o?o.label:null}}(c=h).\u0275fac=function(a){return new(a||c)(e.LFG(l.Rtv))},c.\u0275prov=e.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),(0,T.gn)([(0,S.PS)()],h.prototype,"fetchOpenJobs",null);var p=i(4006);let J=(()=>{var r;class a{constructor(o,t){this.fb=o,this.datePipe=t}createOpenJobsSearchForm(o,t){return this.fb.group({demandId:this.fb.control({value:null,disabled:o},d.YO.demandIdValidator()),country:this.fb.control({value:null,disabled:o}),registrationFromDate:this.fb.control({value:null,disabled:o}),registrationToDate:this.fb.control({value:null,disabled:o}),userId:this.fb.control({value:null,disabled:o}),employerId:this.fb.control({value:null,disabled:o})})}openJobsSearchDetails(o){const t=o.getRawValue();return{demandId:t.demandId?t.demandId:null,country:t.country?t.country:null,registrationFromDate:t.registrationFromDate?this.datePipe.transform(t.registrationFromDate,"yyyy-MM-dd"):null,registrationToDate:t.registrationToDate?this.datePipe.transform(t.registrationToDate,"yyyy-MM-dd"):null,userId:t.userId?t.userId:null,employerId:t.employerId?t.employerId:null}}}return(r=a).\u0275fac=function(o){return new(o||r)(e.LFG(p.qu),e.LFG(u.uU))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),a})();var I=i(1754),D=i(5593),Z=i(2210),y=i(1740),O=i(2453),g=i(4826),w=i(8645);const x=["dt"];function A(r,a){if(1&r){const n=e.EpF();e.TgZ(0,"div",2)(1,"div",30)(2,"button",31),e.NdJ("click",function(){e.CHM(n);const t=e.oxw(),s=e.MAs(37);return e.KtG(t.clearTable(s))}),e.qZA()(),e.TgZ(3,"div",32)(4,"span",33),e._UZ(5,"i",34),e.TgZ(6,"input",35),e.NdJ("ngModelChange",function(t){e.CHM(n);const s=e.oxw();return e.KtG(s.searchInput=t)})("input",function(t){e.CHM(n);const s=e.oxw();return e.KtG(s.applyFilterGlobal(t,"contains"))}),e.qZA()()()()}if(2&r){const n=e.oxw();e.xp6(6),e.Q6J("ngModel",n.searchInput)}}function U(r,a){1&r&&(e.TgZ(0,"tr")(1,"th",36),e._uU(2,"S. No."),e.qZA(),e.TgZ(3,"th",37)(4,"div",38),e._uU(5," Demand ID "),e._UZ(6,"p-sortIcon",39),e.qZA()(),e.TgZ(7,"th",40)(8,"div",38),e._uU(9," Job ID "),e._UZ(10,"p-sortIcon",41),e.qZA()(),e.TgZ(11,"th",42)(12,"div",38),e._uU(13," Job Category "),e._UZ(14,"p-sortIcon",43),e.qZA()(),e.TgZ(15,"th",44)(16,"div",38),e._uU(17," Country "),e._UZ(18,"p-sortIcon",45),e.qZA()(),e.TgZ(19,"th",46)(20,"div",38),e._uU(21," Expiry Date "),e._UZ(22,"p-sortIcon",47),e.qZA()()())}function M(r,a){if(1&r&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td")(4,"span",48),e._uU(5),e.qZA()(),e.TgZ(6,"td")(7,"span",49),e._uU(8),e.qZA()(),e.TgZ(9,"td")(10,"span",48),e._uU(11),e.qZA()(),e.TgZ(12,"td")(13,"span",49),e._uU(14),e.qZA()(),e.TgZ(15,"td")(16,"span",49),e._uU(17),e.ALo(18,"date"),e.qZA()()()),2&r){const n=a.$implicit,o=a.rowIndex;e.xp6(2),e.Oqu(o+1),e.xp6(3),e.Oqu(n.demandId?n.demandId:"NA"),e.xp6(3),e.Oqu(n.jobId?n.jobId:"NA"),e.xp6(3),e.Oqu(n.jobCategory?n.jobCategory:"NA"),e.xp6(3),e.Oqu(n.country?n.country:"NA"),e.xp6(3),e.Oqu(n.expiryDate?e.xi3(18,6,n.expiryDate,"MM-dd-yyyy"):"NA")}}function _(r,a){1&r&&(e.TgZ(0,"tr")(1,"td",50),e._uU(2,"No Demand Found."),e.qZA()())}const R=function(){return[10,25,50]},V=function(){return["demandId","jobId"]},N=function(){return{"min-width":"50rem"}},j=[{path:"view-open-jobs",pathMatch:"full",component:(()=>{var r;class a extends d.H6{constructor(o,t,s,H,Y,G,q){super(t),this.uiService=o,this.router=s,this.searchService=H,this.searchFormHelperService=Y,this.routerQuery=G,this.sessionQuery=q,this.loading=!1,this.isSubmitted=!1,this.countries=[],this.jobCategories=[],this.searchInput=null,this.countryCd=null,this.employerId=null,this.pageInstructionText=l.Xef.PAGE_INSTRUCTION_TEXT,this.pageInstructionHelpText=l.Xef.PAGE_INSTRUCTION_HELP_TEXT,this.feRole=l.Xef.ROLE.FE}ngOnInit(){this.sessionData=this.sessionQuery.user,this.breadcrumb=[{label:this.sessionData.role==this.feRole?"FE":"RA",routerLink:["/admin"]},{label:"Search"},{label:"View Open Jobs"}],this.uiService.initPageSetup(this.breadcrumb,"View Open Jobs"),this.openJobsSearchForm=this.searchFormHelperService.createOpenJobsSearchForm(!1,{}),this.masterData=this.routerQuery.getData(),this.countries=this.masterData[0][l.yfU.COUNTRY],this.jobCategories=this.masterData[0][l.yfU.PROFICIENT_CATEGORY],this.uiService.hideSpinner(),this.openJobsSearchForm.controls.registrationFromDate.valueChanges.subscribe(o=>{o&&(this.minDateTo=new Date(o),this.openJobsSearchForm.patchValue({registrationToDate:null}))}),this.sessionData.role==this.feRole?(this.countryCd=this.sessionData?.employeeDTO?.countryCd,this.employerId=this.feRole+this.sessionData?.employeeDTO?.employerId,this.openJobsSearchForm.patchValue({country:Number(this.countryCd),employerId:this.employerId}),this.openJobsSearchForm.controls.country.disable()):(this.employerId=this.sessionData?.employeeDTO?.employerId,this.openJobsSearchForm.patchValue({userId:this.employerId}))}clearFormData(){this.openJobsSearchForm.reset(),this.sessionData.role==this.feRole&&(this.countryCd=this.sessionData?.employeeDTO?.countryCd,this.employerId=this.feRole+this.sessionData?.employeeDTO?.employerId,this.openJobsSearchForm.patchValue({country:Number(this.countryCd),employerId:this.employerId}))}fetchOpenJobs(){if(null!==this.openJobsSearchForm.controls.registrationFromDate.value&&null==this.openJobsSearchForm.controls.registrationToDate.value||null==this.openJobsSearchForm.controls.registrationFromDate.value&&null!==this.openJobsSearchForm.controls.registrationToDate.value)this.loading=!1,this.showErrorToast("Please enter from and to date to search demands.");else if(null!==this.openJobsSearchForm.controls.country.value||null!==this.openJobsSearchForm.controls.demandId.value||null!==this.openJobsSearchForm.controls.registrationFromDate.value&&null!==this.openJobsSearchForm.controls.registrationToDate.value){this.loading=!0,this.isSubmitted=!0;const o=Object.assign(this.searchFormHelperService.openJobsSearchDetails(this.openJobsSearchForm));this.searchService.fetchOpenJobs(o).subscribe({next:t=>{t.status.toLowerCase()===l.Xef.SUCCESS.toLowerCase()&&t.data.length?(this.openJobs=t.data,this.openJobs&&(this.openJobs.forEach(s=>s.expiryDate=new Date(s.expiryDate)),this.openJobs.forEach(s=>s.jobCategory=this.searchService.fetchValueFromMaster(s.jobCategory,this.jobCategories)),this.openJobs.forEach(s=>s.country=this.searchService.fetchValueFromMaster(s.country,this.countries)))):this.showErrorToast(t.message),this.loading=!1,this.isSubmitted=!1},error:t=>{this.loading=!1,this.isSubmitted=!1,this.showErrorToast(t?.message)},complete:()=>{this.loading=!1,this.isSubmitted=!1}})}else this.loading=!1,this.showErrorToast("Please enter any value to search demands.")}applyFilterGlobal(o,t){this.dt.filterGlobal(o.target.value,t)}clearTable(o){o.clear(),this.searchInput=null}redirectToDashboard(){this.router.navigate(["/admin/dashboard"])}}return(r=a).\u0275fac=function(o){return new(o||r)(e.Y36(v.n),e.Y36(f.ez),e.Y36(m.F0),e.Y36(h),e.Y36(J),e.Y36(I.dt),e.Y36(l.U_o))},r.\u0275cmp=e.Xpm({type:r,selectors:[["emigrate-view-open-jobs"]],viewQuery:function(o,t){if(1&o&&e.Gf(x,5),2&o){let s;e.iGM(s=e.CRH())&&(t.dt=s.first)}},features:[e.qOj],decls:44,vars:26,consts:[[1,"container"],[1,"content","p-3","border","mt-2","mb-2"],[1,"row"],[3,"instructionsText","toolTipText"],[1,"clearfix"],[1,"row_box"],[1,"content"],[1,"form"],[1,"col-md-4","col-sm-6"],[1,"field"],["for","demandId","inputLabel","1. Demand Id / Permit Id","inputId","demandId",1,"block",3,"inputFormControl"],["id","demandId","type","text","pInputText","","placeholder","e.g. DM12345",3,"formControl"],["for","registrationFrom","inputLabel","2. Registration Date From","inputId","registrationFrom",1,"block",3,"inputFormControl"],["appendTo","body","inputId","registrationFrom","placeholder","Registration Date From",1,"w-100",3,"dateFormat","formControl"],["for","registrationTo","inputLabel","3. Registration Date To","inputId","registrationTo",1,"block",3,"inputFormControl"],["appendTo","body","inputId","registrationTo","placeholder","Registration Date To",1,"w-100",3,"dateFormat","formControl","minDate"],["for","country","inputLabel","4. Country","inputId","country",1,"block",3,"inputFormControl"],["id","country","placeholder","Select Country","EmigrateShDropdown","",3,"formControl","options"],[1,"buttons","mb-4"],["pButton","","type","button","label","Clear",1,"btn-format","btn-blue","mr-2",3,"click"],["pButton","","type","submit","label","Search",1,"btn-format","btn-blue",3,"disabled","click"],[1,"card"],["dataKey","jobId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","rows","showCurrentPageReport","rowsPerPageOptions","loading","paginator","globalFilterFields","tableStyle"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"buttons","mt-3"],["pButton","","type","button","label","Close",1,"btn-format","btn-blue",3,"click"],[1,"col-md-4"],["pButton","","label","Clear","icon","pi pi-filter-slash",1,"p-button-outlined","btn-format",3,"click"],[1,"col-md-4","offset-md-4","filter-field"],[1,"p-input-icon-right","w-100"],[1,"pi","pi-search","pt-1","float-right"],["pInputText","","type","text","placeholder","Search Demand ID / Job ID",3,"ngModel","ngModelChange","input"],[2,"min-width","5rem"],["pSortableColumn","demandId",2,"min-width","13rem"],[1,"flex","align-items-center"],["field","demandId"],["pSortableColumn","jobId",2,"min-width","13rem"],["field","jobId"],["pSortableColumn","jobCategory",2,"min-width","13rem"],["field","jobCategory"],["pSortableColumn","country",2,"min-width","13rem"],["field","country"],["pSortableColumn","expiryDate",2,"min-width","13rem"],["field","expiryDate"],[1,"align-items-center","vertical-align-middle"],[1,"text-center","vertical-align-middle"],["colspan","7"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"p-toast"),e.TgZ(3,"div",2),e._UZ(4,"emigrate-sh-page-instructions",3),e.qZA(),e._UZ(5,"div",4),e.TgZ(6,"div",5)(7,"div",6)(8,"h4"),e._uU(9,"Search Details"),e.qZA(),e.TgZ(10,"div",7)(11,"div",2)(12,"div",8)(13,"div",9)(14,"emigrate-sh-html-input",10),e._UZ(15,"input",11),e.qZA()()(),e.TgZ(16,"div",8)(17,"div",9)(18,"emigrate-sh-html-input",12),e._UZ(19,"p-calendar",13),e.qZA()()(),e.TgZ(20,"div",8)(21,"div",9)(22,"emigrate-sh-html-input",14),e._UZ(23,"p-calendar",15),e.qZA()()(),e.TgZ(24,"div",8)(25,"div",9)(26,"emigrate-sh-html-input",16),e._UZ(27,"p-dropdown",17),e.qZA()()()(),e.TgZ(28,"div",18)(29,"button",19),e.NdJ("click",function(){return t.clearFormData()}),e.qZA(),e.TgZ(30,"button",20),e.NdJ("click",function(){return t.fetchOpenJobs()}),e.qZA()()()()(),e.TgZ(31,"div",5)(32,"div",6)(33,"h4"),e._uU(34,"Search Results"),e.qZA(),e.TgZ(35,"div",21)(36,"p-table",22,23),e.YNc(38,A,7,1,"ng-template",24),e.YNc(39,U,23,0,"ng-template",25),e.YNc(40,M,19,9,"ng-template",26),e.YNc(41,_,3,0,"ng-template",27),e.qZA()(),e.TgZ(42,"div",28)(43,"button",29),e.NdJ("click",function(){return t.redirectToDashboard()}),e.qZA()()()()()()),2&o&&(e.xp6(4),e.Q6J("instructionsText",t.pageInstructionText)("toolTipText",t.pageInstructionHelpText),e.xp6(10),e.Q6J("inputFormControl",t.openJobsSearchForm.controls.demandId),e.xp6(1),e.Q6J("formControl",t.openJobsSearchForm.controls.demandId),e.xp6(3),e.Q6J("inputFormControl",t.openJobsSearchForm.controls.registrationFromDate),e.xp6(1),e.Q6J("dateFormat",t.defaultDateFormat)("formControl",t.openJobsSearchForm.controls.registrationFromDate),e.xp6(3),e.Q6J("inputFormControl",t.openJobsSearchForm.controls.registrationToDate),e.xp6(1),e.Q6J("dateFormat",t.defaultDateFormat)("formControl",t.openJobsSearchForm.controls.registrationToDate)("minDate",t.minDateTo),e.xp6(3),e.Q6J("inputFormControl",t.openJobsSearchForm.controls.country),e.xp6(1),e.Q6J("formControl",t.openJobsSearchForm.controls.country)("options",t.countries),e.xp6(3),e.Q6J("disabled",t.isSubmitted),e.xp6(6),e.Q6J("value",t.openJobs)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.DdM(23,R))("loading",t.loading)("paginator",!0)("globalFilterFields",e.DdM(24,V))("tableStyle",e.DdM(25,N)))},dependencies:[p.Fj,p.JJ,p.oH,f.jx,D.Hq,Z.Lt,y.o,O.FN,g.iA,g.lQ,g.fz,w.f,p.On,d.KR,d.dB,d.lC,u.uU],styles:[".filter-field[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]{padding:.5rem .75rem;max-width:100%;width:100%;border:#e1e1e1 solid 1px;font-size:14px}"]}),a})(),resolve:[l.jGp]}];let E=(()=>{var r;class a{}return(r=a).\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[m.Bz.forChild(j),m.Bz]}),a})();var P=i(6270);let Q=(()=>{var r;class a{}return(r=a).\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[u.ez,E,p.UX,P.g,p.u5,y.j,d.uR]}),a})()}}]);